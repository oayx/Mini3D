#version 460

struct type_CommbonRarelyBuffer
{
    vec3 _LIGHTMODEL_AMBIENT;
    int _FogMode;
    vec4 _FogColor;
    float _FogStart;
    float _FogEnd;
    float _FogDensity;
};

uniform type_CommbonRarelyBuffer CommbonRarelyBuffer;

struct type_CustomBuffer
{
    mat4 MATRIX_MVP_LIGHT;
    vec4 _MainTex_ST;
    vec4 _ShadowMap_TexelSize;
    float _Bias;
    int _ShadowType;
};

uniform type_CustomBuffer CustomBuffer;

uniform sampler2D _MainTex;
uniform sampler2D _ShadowMap;

layout(location = 0) in vec2 in_var_TEXCOORD0;
layout(location = 1) in vec4 in_var_TEXCOORD1;
layout(location = 2) in float in_var_TEXCOORD2;
layout(location = 0) out vec4 out_var_SV_Target;

void main()
{
    vec4 _66 = texture(_MainTex, in_var_TEXCOORD0);
    float _138;
    if (CustomBuffer._ShadowType != 0)
    {
        vec2 _77 = ((in_var_TEXCOORD1.xy / vec2(in_var_TEXCOORD1.w)) * 0.5) + vec2(0.5);
        vec2 _79 = _77;
        _79.y = _77.y;
        float _83 = (0.5 * (in_var_TEXCOORD1.z / in_var_TEXCOORD1.w)) + 0.5;
        float _137;
        if (CustomBuffer._ShadowType == 2)
        {
            float _91;
            int _94;
            _91 = 0.0;
            _94 = -1;
            float _92;
            for (; _94 <= 1; _91 = _92, _94++)
            {
                _92 = _91;
                for (int _102 = -1; _102 <= 1; )
                {
                    _92 += float((_83 - CustomBuffer._Bias) > texture(_ShadowMap, _79 + (vec2(float(_94), float(_102)) * CustomBuffer._ShadowMap_TexelSize.xy)).x);
                    _102++;
                    continue;
                }
            }
            _137 = _91 * 0.111111111938953399658203125;
        }
        else
        {
            float _136;
            if (CustomBuffer._ShadowType == 1)
            {
                _136 = float((_83 - CustomBuffer._Bias) > texture(_ShadowMap, _79).x);
            }
            else
            {
                _136 = 0.0;
            }
            _137 = _136;
        }
        _138 = _137;
    }
    else
    {
        _138 = 0.0;
    }
    vec4 _141 = _66 * (1.0 - (_138 * 0.89999997615814208984375));
    float _177;
    if (CommbonRarelyBuffer._FogMode == 1)
    {
        _177 = clamp((CommbonRarelyBuffer._FogEnd - in_var_TEXCOORD2) / (CommbonRarelyBuffer._FogEnd - CommbonRarelyBuffer._FogStart), 0.0, 1.0);
    }
    else
    {
        float _176;
        if (CommbonRarelyBuffer._FogMode == 2)
        {
            _176 = exp(-(CommbonRarelyBuffer._FogDensity * in_var_TEXCOORD2));
        }
        else
        {
            float _175;
            if (CommbonRarelyBuffer._FogMode == 3)
            {
                _175 = exp((((-CommbonRarelyBuffer._FogDensity) * CommbonRarelyBuffer._FogDensity) * in_var_TEXCOORD2) * in_var_TEXCOORD2);
            }
            else
            {
                _175 = 1.0;
            }
            _176 = _175;
        }
        _177 = _176;
    }
    out_var_SV_Target = vec4(max((pow(max(mix(CommbonRarelyBuffer._FogColor.xyz, _141.xyz, vec3(_177)).xyz, vec3(0.0)), vec3(0.4166666567325592041015625)) * 1.05499994754791259765625) - vec3(0.054999999701976776123046875), vec3(0.0)), _141.w);
}

